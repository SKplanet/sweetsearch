<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
        <title></title>
        <link rel="stylesheet" href="./css/demo.css">

    </head>
    <body>

    <div id="wrapper">
        <div class="search-form">
            <div class="search-form-heading"> Smart Search </div>
            <div class="formContainer">
                <form action="" method="post">
                    <div class="inputWrap">
                        <input type="text" class="input-field" name="field1" value="" 
                            autocomplete="off"
                            autocapitalize="off"
                            autocorrect="off"
                        />
                        <div class="clearQuery" style="display:none;">X</div>
                    </div>
                    <div class="buttonWrap">
                        <button type="submit" value="Submit" /> 검색
                    </div>
                </form>
            </div>

            <section class="auto-complete-wrap" style="display:none;">
                <ul class="ul-wrap"></ul>
                <button class="closeLayer">닫기</button>
            </section>

            <section class="recent-word-wrap" style="display:none;">
                <ul class="ul-wrap"></ul>
                <button class="closeLayer">닫기</button>
            </section>
        </div>
    </div>


    <script src="../dist/ss_merge_es5.js"></script>

    <script>

    var oSS= null;

    (function(doc){
        var elAutoCompleteLayer = doc.querySelector(".auto-complete-wrap");
        var elRecentWordLayer   = doc.querySelector(".recent-word-wrap");

        // 서비스에 영향을 직접 받는 API parsing, templating 작업은 컴포넌트 단위에서 하지 않는다.
        var fnInsertAutoCompleteWord = function(sData) {
            var result  = "";
            var sHTML   = "";
            var sTemplate = "<li><span>[%sKeyword%]</span></li>";

            sData.items[0].forEach( function(v) {
                result = sTemplate.replace(/\[%sKeyword%\]/, v[0]);       
                sHTML += result;
            });

            //TODO. 아래코드를 클래스의 메서드로 처리할지를 고민해야 한다.
            elRecentWordLayer.style.display = "none";
            //append html
            elAutoCompleteLayer.style.display = "block";
            elAutoCompleteLayer.querySelector("ul").innerHTML = sHTML;
        }
    
        oSS = new SmartSearch(document.querySelector(".search-form"), {
            //'nDuration' : 100,  //default 100
        });

        oSS.registerCallback({
            'fnInsertAutoCompleteWord' : fnInsertAutoCompleteWord
        });

    })(document);

    </script>
    </body>
</html>





